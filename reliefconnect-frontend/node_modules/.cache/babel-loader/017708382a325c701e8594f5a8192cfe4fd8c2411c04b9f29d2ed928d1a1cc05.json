{"ast":null,"code":"// --- Constants ---\nconst TOKEN_KEY = \"rc_token\";\n\n// --- Save token securely ---\nexport const saveToken = (token, expiresIn = null) => {\n  try {\n    if (!token) throw new Error(\"No token provided\");\n    const payload = {\n      token,\n      expiresAt: expiresIn ? Date.now() + expiresIn * 1000 : null\n    };\n    localStorage.setItem(TOKEN_KEY, JSON.stringify(payload));\n  } catch (err) {\n    console.error(\"❌ Error saving token:\", err);\n  }\n};\n\n// --- Get saved token ---\nexport const getToken = () => {\n  try {\n    const stored = localStorage.getItem(TOKEN_KEY);\n    if (!stored) return null;\n    const {\n      token,\n      expiresAt\n    } = JSON.parse(stored);\n\n    // Check if expired\n    if (expiresAt && Date.now() > expiresAt) {\n      clearToken();\n      console.warn(\"⚠️ Token expired\");\n      return null;\n    }\n    return token;\n  } catch (err) {\n    console.error(\"❌ Error getting token:\", err);\n    return null;\n  }\n};\n\n// --- Remove token (logout) ---\nexport const clearToken = () => {\n  try {\n    localStorage.removeItem(TOKEN_KEY);\n  } catch (err) {\n    console.error(\"❌ Error clearing token:\", err);\n  }\n};\n\n// --- Check if user is authenticated ---\nexport const isAuthenticated = () => !!getToken();\n\n// --- (Optional) Decode JWT payload ---\nexport const decodeToken = () => {\n  try {\n    const token = getToken();\n    if (!token) return null;\n    const [, payload] = token.split(\".\");\n    return JSON.parse(atob(payload));\n  } catch (err) {\n    console.error(\"❌ Error decoding token:\", err);\n    return null;\n  }\n};","map":{"version":3,"names":["TOKEN_KEY","saveToken","token","expiresIn","Error","payload","expiresAt","Date","now","localStorage","setItem","JSON","stringify","err","console","error","getToken","stored","getItem","parse","clearToken","warn","removeItem","isAuthenticated","decodeToken","split","atob"],"sources":["C:/Users/Lenovo/Downloads/ReliefConnect_full_advanced/reliefconnect-frontend/src/utils/auth.js"],"sourcesContent":["// --- Constants ---\r\nconst TOKEN_KEY = \"rc_token\";\r\n\r\n// --- Save token securely ---\r\nexport const saveToken = (token, expiresIn = null) => {\r\n  try {\r\n    if (!token) throw new Error(\"No token provided\");\r\n    const payload = { token, expiresAt: expiresIn ? Date.now() + expiresIn * 1000 : null };\r\n    localStorage.setItem(TOKEN_KEY, JSON.stringify(payload));\r\n  } catch (err) {\r\n    console.error(\"❌ Error saving token:\", err);\r\n  }\r\n};\r\n\r\n// --- Get saved token ---\r\nexport const getToken = () => {\r\n  try {\r\n    const stored = localStorage.getItem(TOKEN_KEY);\r\n    if (!stored) return null;\r\n    const { token, expiresAt } = JSON.parse(stored);\r\n\r\n    // Check if expired\r\n    if (expiresAt && Date.now() > expiresAt) {\r\n      clearToken();\r\n      console.warn(\"⚠️ Token expired\");\r\n      return null;\r\n    }\r\n\r\n    return token;\r\n  } catch (err) {\r\n    console.error(\"❌ Error getting token:\", err);\r\n    return null;\r\n  }\r\n};\r\n\r\n// --- Remove token (logout) ---\r\nexport const clearToken = () => {\r\n  try {\r\n    localStorage.removeItem(TOKEN_KEY);\r\n  } catch (err) {\r\n    console.error(\"❌ Error clearing token:\", err);\r\n  }\r\n};\r\n\r\n// --- Check if user is authenticated ---\r\nexport const isAuthenticated = () => !!getToken();\r\n\r\n// --- (Optional) Decode JWT payload ---\r\nexport const decodeToken = () => {\r\n  try {\r\n    const token = getToken();\r\n    if (!token) return null;\r\n    const [, payload] = token.split(\".\");\r\n    return JSON.parse(atob(payload));\r\n  } catch (err) {\r\n    console.error(\"❌ Error decoding token:\", err);\r\n    return null;\r\n  }\r\n};\r\n"],"mappings":"AAAA;AACA,MAAMA,SAAS,GAAG,UAAU;;AAE5B;AACA,OAAO,MAAMC,SAAS,GAAGA,CAACC,KAAK,EAAEC,SAAS,GAAG,IAAI,KAAK;EACpD,IAAI;IACF,IAAI,CAACD,KAAK,EAAE,MAAM,IAAIE,KAAK,CAAC,mBAAmB,CAAC;IAChD,MAAMC,OAAO,GAAG;MAAEH,KAAK;MAAEI,SAAS,EAAEH,SAAS,GAAGI,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGL,SAAS,GAAG,IAAI,GAAG;IAAK,CAAC;IACtFM,YAAY,CAACC,OAAO,CAACV,SAAS,EAAEW,IAAI,CAACC,SAAS,CAACP,OAAO,CAAC,CAAC;EAC1D,CAAC,CAAC,OAAOQ,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEF,GAAG,CAAC;EAC7C;AACF,CAAC;;AAED;AACA,OAAO,MAAMG,QAAQ,GAAGA,CAAA,KAAM;EAC5B,IAAI;IACF,MAAMC,MAAM,GAAGR,YAAY,CAACS,OAAO,CAAClB,SAAS,CAAC;IAC9C,IAAI,CAACiB,MAAM,EAAE,OAAO,IAAI;IACxB,MAAM;MAAEf,KAAK;MAAEI;IAAU,CAAC,GAAGK,IAAI,CAACQ,KAAK,CAACF,MAAM,CAAC;;IAE/C;IACA,IAAIX,SAAS,IAAIC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,SAAS,EAAE;MACvCc,UAAU,CAAC,CAAC;MACZN,OAAO,CAACO,IAAI,CAAC,kBAAkB,CAAC;MAChC,OAAO,IAAI;IACb;IAEA,OAAOnB,KAAK;EACd,CAAC,CAAC,OAAOW,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEF,GAAG,CAAC;IAC5C,OAAO,IAAI;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMO,UAAU,GAAGA,CAAA,KAAM;EAC9B,IAAI;IACFX,YAAY,CAACa,UAAU,CAACtB,SAAS,CAAC;EACpC,CAAC,CAAC,OAAOa,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;EAC/C;AACF,CAAC;;AAED;AACA,OAAO,MAAMU,eAAe,GAAGA,CAAA,KAAM,CAAC,CAACP,QAAQ,CAAC,CAAC;;AAEjD;AACA,OAAO,MAAMQ,WAAW,GAAGA,CAAA,KAAM;EAC/B,IAAI;IACF,MAAMtB,KAAK,GAAGc,QAAQ,CAAC,CAAC;IACxB,IAAI,CAACd,KAAK,EAAE,OAAO,IAAI;IACvB,MAAM,GAAGG,OAAO,CAAC,GAAGH,KAAK,CAACuB,KAAK,CAAC,GAAG,CAAC;IACpC,OAAOd,IAAI,CAACQ,KAAK,CAACO,IAAI,CAACrB,OAAO,CAAC,CAAC;EAClC,CAAC,CAAC,OAAOQ,GAAG,EAAE;IACZC,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,GAAG,CAAC;IAC7C,OAAO,IAAI;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}